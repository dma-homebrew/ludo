#optimize
10000 'L U D O   MAIN PROGRAM
10010 '
10020 'WRITTEN BY XANDER MOL
10030 'CONVERTED TO ORIC ATMOS
10040 'IN 2020
10050 'ORIGINAL WRITTEN IN 1992
10060 'FOR COMMODORE 128
10070 '(C)2020 IDREAMTIN8BITS.COM
10080 :
10090 RANDOM
10110 B$="": O$=""
10120 FOR C=1 TO 40
10130 : B$=B$+CHR$(94): O$=O$+CHR$(93)
10140 NEXT
10150 CI$="0123456789"
10160 LC$="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"+CI$
10170 AL$=LC$+" !#$%&'()"+CHR$(34)+"+-@*^:[;]=,<.>/?_"
10180 RESTORE
10190 S$="                                        "
10200 AD=#A000:WN=1: DIM WI(10,2): MU=1: CC=0
10210 GOSUB10630
10220 GOSUB14840
10230 XC=18:YC=8:B=20:H=6:GOSUB16340
10240 PRINT@20,10;CHR$(131);"Load old game?";CHR$(129)
10250 XC=27:YC=11:MN=5:GOSUB15340
10260 GOSUB15280
10270 IFM=1THENGOSUB13660
10280 :
10290 'MAIN GAMELOOP
10300 :
10310 REPEAT
10320 : GOSUB10570
10330 : IFEI<>2THENGOSUB11570:GOSUB11420:GOTO10350
10340 : EI=0:GOSUB14120
10350 : REPEAT
10360 :   PRINT@0,2;LEFT$(S$,39):PRINT@0,3;LEFT$(S$,39)
10370 :   PRINT@0,4;LEFT$(S$,39)
10380 :   PRINT@0,2;CHR$(131);"Player";CHR$(134);BS+1;CHR$(131);": ";
10390 :    PRINTCHR$(144+SP(BS,2));" ";CHR$(144)
10400 :   PRINT@0,3;CHR$(130);SP$(BS);CHR$(131);LEFT$(S$,10)
10410 :   IFSP(BS,0)=0THENGOSUB11960:GOTO10430
10420 :     PRINT@0,4;CHR$(131);"Computer is playing."
10430 :   IFEI<>0THENPULL:GOTO10520
10440 :   GOSUB12110
10450 :   IFSP(BS,1)=0THENGOSUB14270
10460 :   IFEI<>0THENPULL:GOTO10520
10470 :   REPEAT
10480 :     IFZV=1THENZV=0:GOTO10500
10490 :       NP(NS)=-1:BS=BS+1:IFBS>3THENBS=0
10500 :   UNTIL(ZV<>0 OR SP(BS,1)<>0)
10510 : UNTILEI<>0
10520 UNTILEI=1
10530 GOTO16470
10540 :
10550 'LOAD MAIN SCREEN
10560 :
10570 LOAD "LUDOSCRM.BIN"
10580 GOSUB15130
10590 RETURN
10600 :
10610 'INITIALISATION
10620 :
10630 DIMVC(39,1),RC(3,7,1),SP$(3),SP(3,3),DN$(5,1),SC(3,3,1)
10640 DIMPM(3),NP(3),PW(3)
10650 FORN=0TO39:READVC(N,0),VC(N,1):NEXTN
10660 FORN=0TO3
10670 : FORM=0TO7:READRC(N,M,0),RC(N,M,1):NEXTM
10680 NEXTN
10690 FORN=0TO3:READSP(N,2):NEXTN
10700 FORN=0TO5
10710 : READA,B,C,D:DN$(N,0)=CHR$(A)+CHR$(B):DN$(N,1)=CHR$(C)+CHR$(D)
10720 NEXTN
10730 RETURN
10740 :
10750 'CO-ORDINATES OF PAWN
10760 :
10770 IFSC(BS,PN,0)<>0THENGOTO10790
10780 : XC=VC(SC(BS,PN,1),0):YC=VC(SC(BS,PN,1),1):GOTO10800
10790 XC=RC(BS,SC(BS,PN,1),0):YC=RC(BS,SC(BS,PN,1),1)
10800 RETURN
10810 :
10820 'ERASE PAWN
10830 :
10840 GOSUB10770
10850 IFSC(BS,PN,0)=0ANDSC(BS,PN,1)/10=INT(SC(BS,PN,1)/10)THENGOTO10960
10860 'NORMAL WHITE FIELD MAIN TRACK
10870 IFSC(BS,PN,0)<>0THENGOTO10920
10880 : PRINT@XC-1,YC;CHR$(135);" !"
10890 : PRINT@XC-1,YC+1;CHR$(135);CHR$(34);"#";
10900 : GOTO11110
10910 'COLORED HOME OR DEST FIELD
10920 PRINT@XC-1,YC;CHR$(128+SP(BS,2));"$%"
10930 PRINT@XC-1,YC+1;CHR$(128+SP(BS,2));"&";CHR$(39);
10940 GOTO11110
10950 'COLORED START FIELDS
10960 IFSC(BS,PN,1)<>0THENGOTO11000
10970 : PRINT@XC-1,YC;CHR$(130);",-"
10980 : PRINT@XC-1,YC+1;CHR$(130);"./";
10990 : GOTO11110
11000 IFSC(BS,PN,1)<>10THENGOTO11040
11010 : PRINT@XC-1,YC;CHR$(129);"01"
11020 : PRINT@XC-1,YC+1;CHR$(129);"23";
11030 : GOTO11110
11040 IFSC(BS,PN,1)<>20THENGOTO11080
11050 : PRINT@XC-1,YC;CHR$(132);"45"
11060 : PRINT@XC-1,YC+1;CHR$(132);"67";
11070 : GOTO11110
11080 IFSC(BS,PN,1)<>30THENGOTO11110
11090 : PRINT@XC-1,YC;CHR$(131);"89"
11100 : PRINT@XC-1,YC+1;CHR$(131);":;";
11110 RETURN
11120 :
11130 'PLACE PAWN
11140 :
11150 GOSUB10770
11160 IFCC=1THENGOTO11200
11170 : PRINT@XC-1,YC;CHR$(128+SP(BS,2));"()"
11180 : PRINT@XC-1,YC+1;CHR$(128+SP(BS,2));"*+";
11190 GOTO 11220
11200 : PRINT@XC-1,YC;CHR$(135);"()"
11210 : PRINT@XC-1,YC+1;CHR$(135);"*+";
11220 RETURN
11230 :
11240 'THROW DICE
11250 :
11260 XC=30:YC=12:B=8:H=6:GOSUB16340
11270 PRINT@32,14;CHR$(27);"I";CHR$(135);CHR$(160);CHR$(160);
11280 PRINTCHR$(129);CHR$(27);"H"
11290 PRINT@32,15;CHR$(27);"I";CHR$(135);CHR$(160);CHR$(160);
11300 PRINTCHR$(129);CHR$(27);"H"
11310 FORN=1TO10
11320 : DG=INT(RND(1)*6)+1
11330 : PLOT 34,14,DN$(DG-1,0): PLOT 34,15,DN$(DG-1,1)
11340 : FORW=1TO10:NEXTW
11350 NEXTN
11360 PRINT@32,17;CHR$(131);"Key.";CHR$(129)
11370 GOSUB16540:GOSUB15280
11380 RETURN
11390 :
11400 'INPUT OF NAMES
11410 :
11420 XC=4:YC=8:B=34:H=6:GOSUB16340
11430 FORSP=0TO3
11440 : PRINT@6,10;CHR$(131);"Computer plays for player";CHR$(134);
11450 : PRINTSP+1;CHR$(131);"?";CHR$(129)
11460 : XC=28:YC=11:MN=5:GOSUB15340
11470 : IFM=1THENSP(SP,0)=1ELSESP(SP,0)=0
11480 : PRINT@6,10;CHR$(131);"Input name for player";CHR$(134);
11490 : PRINTSP+1;CHR$(131);":    ";CHR$(129)
11500 : XC=6:YC=12:ML=20:TT$=AL$:GOSUB15980:SP$(SP)=AN$
11510 NEXTSP
11520 GOSUB15280
11530 RETURN
11540 :
11550 'GAME RESET
11560 :
11570 BS=0:EI=0
11580 FORN=0TO3
11590 : SP(N,1)=4:SP(N,3)=4:NP(N)=-1:DP(N)=8
11600 : FORM=0TO3
11610 :   SC(N,M,0)=1:SC(N,M,1)=M
11620 : NEXTM
11630 NEXTN
11640 RETURN
11650 :
11660 'INFORMATION: CREDITS
11670 :
11680 XC=2:YC=8:B=36:H=11:GOSUB16340:B=B-1
11690 PRINT@4,10;CHR$(134);:CT$="L U D O"
11700 GOSUB16580:PRINTCHR$(129)
11710 PRINT@4,11;CHR$(131);:CT$="Written by Xander Mol"
11720 GOSUB16580:PRINTCHR$(129)
11730 PRINT@4,12;CHR$(131);:CT$="Converted to Oric Atmos, 2020"
11740 GOSUB16580:PRINTCHR$(129)
11750 PRINT@4,13;CHR$(131);:CT$="Original on Commodore 128, 1992"
11760 GOSUB16580:PRINTCHR$(129)
11770 PRINT@4,14;CHR$(131);:CT$="Build with and using code of"
11780 GOSUB16580:PRINTCHR$(129)
11790 PRINT@4,15;CHR$(131);:CT$="OSDK,"+CHR$(96)+" DBug and OSDK authors."
11800 GOSUB16580:PRINTCHR$(129)
11810 PRINT@4,17;CHR$(130);:CT$="Press a key."
11820 GOSUB16580:PRINTCHR$(129)
11830 GOSUB16540:GOSUB15280
11840 RETURN
11850 :
11860 'QUESTION: ARE YOU SURE?
11870 :
11880 XC=8:YC=8:B=30:H=6:GOSUB16340
11890 PRINT@10,10;CHR$(131)"Are you sure ?";CHR$(129);
11900 XC=25:YC=11:MN=5:GOSUB15340
11910 GOSUB15280
11920 RETURN
11930 :
11940 'TURN HUMAN PLAYER
11950 :
11960 REPEAT
11970 : GOSUB15770
11980 : IFMN=1ANDM=2THENGOSUB11880:IFM=1THENEI=3:PULL:GOTO12070
11990 : IFMN=1ANDM=3THENGOSUB11880:IFM=1THENEI=1:PULL:GOTO12070
12000 : IFMN=2ANDM=1THENGOSUB13210:M=1
12010 : IFMN=2ANDM=2THENGOSUB11880:IFM=1THENGOSUB13660:PULL:GOTO12070
12020 : IFMN=3ANDM=1THENGOSUB16710
12030 : IFMN=3ANDM=2THENCALL#6503
12040 : IFMN=3ANDM=3THENCALL#6503:CALL#6500
12050 : IFMN=4ANDM=1THENGOSUB11680
12060 UNTIL MN=1 AND M=1
12070 RETURN
12080 :
12090 'TURN GENERIC
12100 :
12110 GA=1:GB=0:MP=0:PN=-1:AP=0:ZV=0
12120 FORN=0TO3:PM(N)=0:NEXTN
12130 IFSP(BS,3)=SP(BS,1)THENGA=3:PRINT@21,3;CHR$(131);"Throw 3 times."
12140 FORD=1TOGA
12150 : GOSUB11260
12160 : IFDG=6THEND=GA
12170 NEXTD
12180 PRINT@21,3;LEFT$(S$,15)
12190 IFSP(BS,3)=SP(BS,1)ANDDG<>6THENGB=1
12200 IFNP(BS)<0THENGOTO12230
12210 : IFSP(BS,3)>0THENPN=NP(BS):NP(BS)=-1:GOTO12230
12220 :   NP(BS)=-1
12230 IFGB<>0ORPN<>-1THENGOTO12410
12240 : FORN=0TO3
12250 :   VR=SC(BS,N,0):VL=SC(BS,N,1):GV=0
12260 :   IFVR=1ANDVL<4THENGV=1:IFDG=6THENPN=N:NP(BS)=N:N=3
12270 :   IFGV<>0THENGOTO12400
12280 :   VN=VL+DG:NR=VR
12290 :   IFVR<>0THENGOTO12340
12300 :     IFBS=0ANDVN>39ANDVL<40THENVN=VN-36:NR=1
12310 :     IFBS=1ANDVN>9ANDVL<10THENVN=VN-6:NR=1
12320 :     IFBS=2ANDVN>19ANDVL<20THENVN=VN-16:NR=1
12330 :     IFBS=3ANDVN>29ANDVL<30THENVN=VN-26:NR=1
12340 :   IFNR<>1THENGOTO12390
12350 :   IFVN>7THENGV=1:GOTO12390
12360 :   FORM=0TO3
12370 :   IFN<>MANDSC(BS,M,0)=1ANDSC(BS,M,1)<=VNANDSC(BS,M,1)>3THENGV=1:M=3
12380 :   NEXTM
12390 :   IFGV=0THENPM(N)=1
12400 : NEXTN
12410 IFPN<>-1THENGOTO12460
12420 : FORN=0TO3
12430 :   IFPM(N)=1THENAP=AP+1:PN=N
12440 : NEXTN
12450 : GOTO12470
12460 AP=1
12470 IFAP<=1THENGOTO12490
12480 : IFSP(BS,0)=0THENGOSUB12920ELSEGOSUB14400
12490 IFDG=6THENZV=1
12500 IFAP<>0ANDGB<>1THENGOTO12550
12510 : PRINT@21,2;CHR$(131);"No move possible"
12520 : PRINT@21,3;CHR$(131);"Press key"
12530 : GOSUB16540
12540 : RETURN
12550 GOSUB10840
12560 OV=SC(BS,PN,1):RO=SC(BS,PN,0)
12570 IFRO<>1OROV>=4THENGOTO12600
12580 : SC(BS,PN,0)=0:SC(BS,PN,1)=BS*10:SP(BS,3)=SP(BS,3)-1
12590 : GOTO12610
12600 SC(BS,PN,1)=SC(BS,PN,1)+DG
12610 IFBS<>0ORSC(BS,PN,1)<=39OROV>=40ORRO<>0THENGOTO12630
12620 : SC(BS,PN,0)=1:SC(BS,PN,1)=SC(BS,PN,1)-36
12630 IFBS<>1ORSC(BS,PN,1)<=9OROV>=10ORRO<>0THENGOTO12650
12640 : SC(BS,PN,0)=1:SC(BS,PN,1)=SC(BS,PN,1)-6
12650 IFBS<>2ORSC(BS,PN,1)<=19OROV>=20ORRO<>0THENGOTO12670
12660 : SC(BS,PN,0)=1:SC(BS,PN,1)=SC(BS,PN,1)-16
12670 IFBS<>3ORSC(BS,PN,1)<=29OROV>=30ORRO<>0THENGOTO12690
12680 : SC(BS,PN,0)=1:SC(BS,PN,1)=SC(BS,PN,1)-26
12690 IFSC(BS,PN,0)=1ANDSC(BS,PN,1)>3THENDP(BS)=SC(BS,PN,1)
12700 IFSC(BS,PN,1)=SP(BS,1)+3ANDSC(BS,PN,0)=1THENSP(BS,1)=SP(BS,1)-1
12710 IFSC(BS,PN,1)>39THENSC(BS,PN,1)=SC(BS,PN,1)-40
12720 AP=0:AS=-1
12730 FORSP=0TO3
12740 : FORPO=0TO3
12750 :   IFPO=PNANDSP=BSTHENGOTO12780
12760 :     IFSC(SP,PO,0)<>0ORSC(BS,PN,0)<>0THENGOTO12780
12770 :       IFSC(SP,PO,1)=SC(BS,PN,1)THENAP=PO:AS=SP:PO=3:SP=3
12780 : NEXTPO
12790 NEXTSP
12800 IFAS=-1THENGOTO12870
12810 : H1=BS:H2=PN
12820 : BS=AS:PN=AP
12830 : GOSUB10840
12840 : SC(BS,PN,0)=1:SC(BS,PN,1)=PN:SP(BS,3)=SP(BS,3)+1
12850 : GOSUB11150
12860 : BS=H1:PN=H2
12870 GOSUB11150
12880 RETURN
12890 :
12900 'HUMAN PLAYER CHOOSE PAWN
12910 :
12920 XC=20:YC=1:B=18:H=2:GOSUB16340
12930 PRINT@22,2;CHR$(131);"Which pawn?";CHR$(129)
12940 PRINT@22,3;CHR$(131);"Thrown:";DG;CHR$(129)
12950 PN=0
12960 REPEAT
12970 : PN=PN+1
12980 UNTIL PM(PN)=1
12990 REPEAT
13000 CC=1:GOSUB11150:CC=0
13010 JM=1:TT$=CHR$(8)+CHR$(9)+CHR$(10)+CHR$(11)+CHR$(13)
13020 TJ$="11111111":GOSUB15660
13030 GOSUB11150
13040 IFAW$=CHR$(8)ORAW$=CHR$(10)ORJW=5ORJW=6ORJW=7ORJW=8THENPN=PN-1:RI=-1
13050 IFAW$=CHR$(9)ORAW$=CHR$(11)ORJW=1ORJW=2ORJW=3ORJW=4THENPN=PN+1:RI=1
13060 IFAW$=CHR$(13)ORJW>=128THENPULL:GOTO13160
13070 IFPN>3THENPN=0
13080 IFPN<0THENPN=3
13090 REPEAT
13100 : IFPM(PN)=1THENPULL:GOTO13150
13110 : PN=PN+RI
13120 : IFPN>3THENPN=0
13130 : IFPN<0THENPN=3
13140 UNTIL PM(PN)=1
13150 UNTIL AW$=CHR$(13)
13160 GOSUB15280
13170 RETURN
13180 :
13190 'SAVE GAME
13200 :
13210 XC=8:YC=8:B=30:H=7:GOSUB16340
13220 PRINT@10,10;CHR$(130);"Save game.";CHR$(129)
13230 PRINT@10,12;CHR$(131);"Enter filename:";CHR$(129)
13240 XC=10:YC=14:ML=8:TT$=AL$:GOSUB15980:GOSUB15280:IFAN$=""THENRETURN
13250 AN$=AN$+".SAV"
13260 ERR SET: ERRGOTO 13610
13270 SEARCH AN$
13280 IFEF=0THENGOTO13350
13290 : XC=8:YC=8:B=30:H=8:GOSUB16340
13300 : PRINT@10,10;CHR$(131);"Filename exists.";CHR$(129)
13310 : PRINT@10,11;CHR$(131);"Replace?";CHR$(129)
13320 : XC=15:YC=13:MN=5:GOSUB15340
13330 : GOSUB15280
13340 : IFM=2THENRETURN
13350 AS=#B001
13360 POKE #B000,BS
13370 FORN=0TO3
13380 : IFNP(N)<0THENPOKEAS,256+NP(N)ELSEPOKEAS,NP(N)
13390 : AS=AS+1
13400 NEXTN
13410 FORN=0TO3
13420 : FORM=0TO3
13430 :   POKE AS,SP(N,M):AS=AS+1
13440 : NEXTM
13450 NEXTN
13460 FORN=0TO3
13470 : FORM=0TO3
13480 :   POKE AS,SC(N,M,0): AS=AS+1
13490 :   POKE AS,SC(N,M,1): AS=AS+1
13500 : NEXTM
13510 NEXTN
13520 FORN=0TO3
13530 : POKE AS,LEN(SP$(N)):AS=AS+1
13540 : FORM=1TOLEN(SP$(N))
13550 :   POKE AS,ASC(MID$(SP$(N),M,1)):AS=AS+1
13560 : NEXTM
13570 NEXTN
13580 SAVEO AN$,A#B000,E#B100
13590 ERR OFF: RETURN
13600 'ERROR HANDLING
13610 GOSUB16640: ERR OFF
13620 RETURN
13630 :
13640 'LOAD GAME
13650 :
13660 XC=8:YC=8:B=30:H=8
13670 GOSUB16340
13680 PRINT@10,10;CHR$(131);"Load game.";CHR$(129)
13690 PRINT@10,12;CHR$(131);"Filename (without .SAV):";CHR$(129)
13700 XC=10:YC=14:ML=8:TT$=AL$:GOSUB15980:GOSUB15280:IFAN$=""THENRETURN
13710 AN$=AN$+".SAV"
13720 ERR SET: ERRGOTO 14070
13730 SEARCH AN$
13740 IFEF<>0THENGOTO13790
13750 : XC=8:YC=8:B=30:H=6:GOSUB16340
13760 : PRINT@10,10;CHR$(131);"File not found.";CHR$(129)
13770 : PRINT@10,11;CHR$(131);"Press key.";CHR$(129):GOSUB16540
13780 : GOSUB15280:RETURN
13790 LOAD AN$
13800 BS=PEEK(#B000):AS=#B001
13810 FORN=0TO3
13820 : NP(N)=PEEK(AS):AS=AS+1
13830 : IFNP(N)>127THENNP(N)=-(256-NP(N))
13840 NEXTN
13850 FORN=0TO3
13860 : FORM=0TO3
13870 :   SP(N,M)=PEEK(AS):AS=AS+1
13880 : NEXTM
13890 NEXTN
13900 FORN=0TO3
13910 : FORM=0TO3
13920 :   SC(N,M,0)=PEEK(AS):AS=AS+1
13930 :   SC(N,M,1)=PEEK(AS):AS=AS+1
13940 : NEXTM
13950 NEXTN
13960 FORN=0TO3
13970 : ML=PEEK(AS):AS=AS+1
13980 : SP$(N)=""
13990 : FORM=1TOML
14000 :   SP$(N)=SP$(N)+CHR$(PEEK(AS)):AS=AS+1
14010 : NEXTM
14020 NEXTN
14030 EI=2
14040 ERR OFF
14050 RETURN
14060 'ERROR HANDLING
14070 GOSUB16640: ERR OFF
14080 RETURN
14090 :
14100 'PLACE PAWNS AFTER LOAD
14110 :
14120 H1=BS
14130 FORBS=0TO3
14140 : FORPN=0TO3
14150 :   H2=SC(BS,PN,0):H3=SC(BS,PN,1)
14160 :   SC(BS,PN,0)=1:SC(BS,PN,1)=PN
14170 :   GOSUB10840
14180 :   SC(BS,PN,0)=H2:SC(BS,PN,1)=H3
14190 :   GOSUB11150
14200 : NEXTPN
14210 NEXTBS
14220 BS=H1
14230 RETURN
14240 :
14250 'A PLAYER HAS WON THE GAME
14260 :
14270 XC=3:YC=8:B=35:H=9:GOSUB16340
14280 PRINT@5,10;CHR$(130);SP$(BS);CHR$(131);" has won the game!";
14290 PRINTCHR$(129)
14300 PRINT@5,12;CHR$(131);"What do you want?";CHR$(129)
14310 XC=15:YC=13:MN=7:GOSUB15340
14320 IFM=1ANDSP(0,1)=0ANDSP(1,1)=0ANDSP(2,1)=0ANDSP(3,1)=0THENGOTO14310
14330 IFM=2THENEI=3:ZV=1
14340 IFM=3THENEI=1:ZV=1
14350 GOSUB15280
14360 RETURN
14370 :
14380 'CHOOSE PAWN COMPUTER PLAYER
14390 :
14400 FORN=0TO3:PW(N)=0:NEXTN
14410 FORN=0TO3
14420 IFPM(N)=0THENPW(N)=-10000:GOTO14750
14430 VR=SC(BS,N,0):VN=SC(BS,N,1)
14440 NN=VN+DG:NO=NN:NR=VR
14450 IFVR<>0THENGOTO14500
14460 IFBS=0ANDNN>39ANDVN<40THENNN=NN-36:NR=1
14470 IFBS=1ANDNN>9ANDVN<10THENNN=NN-6:NR=1
14480 IFBS=2ANDNN>19ANDVN<20THENNN=NN-16:NR=1
14490 IFBS=3ANDNN>29ANDVN<30THENNN=NN-26:NR=1
14500 IFNR=0ANDNN>39THENNN=NN-40
14510 IFNR=1ANDNN>3ANDSP(BS,1)=1THENPW(N)=10000:N=3:GOTO14750
14520 IFNR=1ANDNN>3THENPW(N)=PW(N)+6000
14530 FORSP=0TO3
14540 FORPO=0TO3
14550 IFBS=SPANDSC(SP,PO,0)=NRANDSC(SP,PO,1)=NNTHENPW(N)=PW(N)-8000
14560 IFBS=SPORSC(SP,PO,0)<>NRORSC(SP,PO,1)<>NNTHENGOTO14630
14570 PW(N)=PW(N)+4000
14580 IFSC(SP,PO,0)<>0THENGOTO14630
14590 IFSP=0ANDSC(SP,PO,1)>33THENPW(N)=PW(N)+3000
14600 IFSP=1ANDSC(SP,PO,1)>3THENPW(N)=PW(N)+3000
14610 IFSP=2ANDSC(SP,PO,1)>13THENPW(N)=PW(N)+3000
14620 IFSP=3ANDSC(SP,PO,1)>23THENPW(N)=PW(N)+3000
14630 IFSC(SP,PO,0)<>0ORNR<>0ORBS=SPTHENGOTO14670
14640 IF(VN-SC(SP,PO,1))<6AND(VN-SC(SP,PO,1))>0THENPW(N)=PW(N)+400
14650 IF(NO-SC(SP,PO,1))<6AND(NO-SC(SP,PO,1))>0THENPW(N)=PW(N)-200
14660 IF(SC(SP,PO,1)-NN)<6AND(SC(SP,PO,1)-NN)>0THENPW(N)=PW(N)+100
14670 NEXTPO
14680 NEXTSP
14690 IFNR=0AND(NN=0ORNN=10ORNN=20ORNN=30)THENPW(N)=PW(N)-4000
14700 IFVR=0AND(VN=0ORVN=10ORVN=20ORVN=30)THENPW(N)=PW(N)+2000
14710 IFBS=0THENPW(N)=PW(N)+NN
14720 IFBS=1THENPW(N)=PW(N)+(NO-10)
14730 IFBS=2THENPW(N)=PW(N)+(NO-20)
14740 IFBS=3THENPW(N)=PW(N)+(NO-30)
14750 NEXTN
14760 MW=-20000
14770 FORN=0TO3
14780 : IFPW(N)>MWTHENMW=PW(N):PN=N
14790 NEXTN
14800 RETURN
14810 :
14820 'READ MENUDATA
14830 :
14840 READMN,DN
14850 DIMMN$(MN+DN+2,16),MN(MN+DN+2),MC(MN,1)
14860 MC=1:MN(0)=MN
14870 FORN=1TOMN(0)
14880 : READMN$(N,0)
14890 : READMN(N)
14900 : MC(N,0)=MC:MC(N,1)=MC+LEN(MN$(N,0)):MC=MC(N,1)+1:ML=0
14910 : FORM=1TOMN(N)
14920 :   READMN$(N,M)
14930 :   IFLEN(MN$(N,M))>MLTHENML=LEN(MN$(N,M))
14940 : NEXTM
14950 : FORM=1TOMN(N)
14960 :   MN$(N,M)=MN$(N,M)+LEFT$(S$,ML-LEN(MN$(N,M)))
14970 : NEXTM
14980 NEXTN
14990 FORN=1TODN
15000 : READMN(MN(0)+N):ML=0
15010 : FORM=1TOMN(MN(0)+N)
15020 :   READMN$(MN(0)+N,M)
15030 :   IFLEN(MN$(MN(0)+N,M))>MLTHENML=LEN(MN$(MN(0)+N,M))
15040 : NEXTM
15050 : FORM=1TOMN(MN(0)+N)
15060 :   MN$(MN(0)+N,M)=MN$(MN(0)+N,M)+LEFT$(S$,ML-LEN(MN$(MN(0)+N,M)))
15070 : NEXTM
15080 NEXTN
15090 RETURN
15100 :
15110 'PLACE MENU BAR
15120 :
15130 PRINT @0,0;CHR$(128);CHR$(146);
15140 FORN=1TOMN(0)
15150 : PRINT MN$(N,0);" ";
15160 NEXTN
15170 RETURN
15180 :
15190 'SAVE SCREEN
15200 :
15210 WI(WN,0)=AD: WI(WN,1)=YC-1: WI(WN,2)=H+3
15220 MOVE #BBA8+WI(WN,1)*40,#BBA8+(WI(WN,1)+WI(WN,2))*40,WI(WN,0)
15230 AD=AD+WI(WN,2)*40:WN=WN+1
15240 RETURN
15250 :
15260 'LOAD SCREEN BACK
15270 :
15280 WN=WN-1: AD=WI(WN,0)
15290 MOVE WI(WN,0),WI(WN,0)+WI(WN,2)*40,#BBA8+WI(WN,1)*40
15300 RETURN
15310 :
15320 'MENU
15330 :
15340 H=MN(MN)+2
15350 GOSUB15210
15360 IFMN<=MN(0)THENGOTO15380
15370 : PRINT@XC,YC;CHR$(129);CHR$(125);LEFT$(B$,4+LEN(MN$(MN,1)))
15380 FORN=1TOMN(MN)
15390 : PRINT@XC,YC+N;CHR$(129);CHR$(91);CHR$(150);CHR$(128);
15400 : PRINTMN$(MN,N);CHR$(129);CHR$(91);CHR$(144)
15410 NEXTN
15420 PRINT@XC,YC+N;CHR$(129);CHR$(123);LEFT$(O$,4+LEN(MN$(MN,1)));
15430 M=1:TT$=CHR$(11)+CHR$(10)+CHR$(13):TJ$="11011101"
15440 IFMN<=MN(0)THENTT$=TT$+CHR$(8)+CHR$(9):TJ$="11111111"
15450 EX=0
15460 REPEAT
15470 : PRINT@XC+2,YC+M;CHR$(147);CHR$(128);MN$(MN,M);
15480 : PRINTCHR$(129);CHR$(91);CHR$(144)
15490 : JM=1:GOSUB15660:JM=0
15500 : IF AW$=CHR$(13) OR JW>=128THEN EX=1
15510 : IFAW$=CHR$(8)ORJW=7THENM=0:EX=1:GOTO15600
15520 : IFAW$=CHR$(9)ORJW=3THENM=0:EX=1:GOTO15600
15530 : IFEX<>0THENGOTO15560
15540 :   PRINT@XC+2,YC+M;CHR$(150);CHR$(128);MN$(MN,M);
15550 :   PRINTCHR$(129);CHR$(91);CHR$(144)
15560 : IFAW$=CHR$(11)ORJW=1ORJW=2ORJW=8THENM=M-1
15570 : IFAW$=CHR$(10)ORJW=4ORJW=5ORJW=6THENM=M+1
15580 : IFM>MN(MN)THENM=1
15590 : IFM<1THENM=MN(MN)
15600 UNTIL EX=1
15610 GOSUB15280
15620 RETURN
15630 :
15640 'ASK FOR KEYPRESS OR JOYSTICK
15650 :
15660 POKE 735,0
15665 REPEAT
15680 : GETAW$: INSTR TT$,AW$,1
15690 'TBD FOR READING JOYSTICK
15700 : JW=0
15710 UNTIL IN>0
15730 RETURN
15740 :
15750 'MAIN MENU
15760 :
15770 MN=1:M=0
15780 REPEAT
15790 : REPEAT
15800 :   PRINT@MC(MN,0),0;CHR$(151);MN$(MN,0);CHR$(146)
15810 :   TT$=CHR$(8)+CHR$(9)+CHR$(13):TJ$="01110111"
15820 :   JM=1:GOSUB15660:JM=0
15830 :   PRINT@MC(MN,0),0;CHR$(146);MN$(MN,0);
15840 :   IFAW$=CHR$(8)ORJW=6ORJW=7ORJW=8THENMN=MN-1
15850 :   IFAW$=CHR$(9)ORJW=2ORJW=3ORJW=4THENMN=MN+1
15860 :   IFMN<1THENMN=MN(0)
15870 :   IFMN>MN(0)THENMN=1
15880 : UNTILAW$=CHR$(13) OR JW>=128
15890 : XC=MC(MN,0)-1:YC=0
15900 : IFXC+LEN(MN$(MN,1))>38THENXC=MC(MN,1)-LEN(MN$(MN,1))
15910 : GOSUB15340
15920 UNTIL M<>0
15930 PRINT@MC(MN,0),0;CHR$(146);MN$(MN,0);
15940 RETURN
15950 :
15960 'INPUT ROUTINE
15970 :
15980 AN$="":KN=1:PR$=""
16000 TT$=TT$+CHR$(13)+CHR$(8)+CHR$(9)+CHR$(127)
16010 PRINT@XC,YC;CHR$(135);LEFT$(B$,ML-LEN(AN$)-1);" ";CHR$(129)
16020 REPEAT
16030 : IFKN>LEN(AN$)THENGOTO16070
16040 :   PR$=LEFT$(AN$,KN-1)+CHR$(128+ASC(MID$(AN$,KN,1)))
16050 :   PR$=PR$+RIGHT$(AN$,LEN(AN$)-KN)+LEFT$(B$,ML-LEN(AN$))
16060 :   GOTO 16080
16070 : PR$=AN$+CHR$(160)+LEFT$(B$,ML-LEN(AN$)-1)
16080 : PLOTXC+1,YC,PR$
16090 : GOSUB15660
16100 : IFAW$=CHR$(13)THENPULL:GOTO16280
16110 : INSTR CHR$(8)+CHR$(9)+CHR$(127),AW$,1
16120 : IFIN<>0THENGOTO16190
16130 :   IFKN>LEN(AN$)THENGOTO16160
16140 :     AN$=LEFT$(AN$,KN-1)+AW$+RIGHT$(AN$,LEN(AN$)-KN)
16150 :     GOTO16170
16160 :   AN$=AN$+AW$
16170 :   KN=KN+1
16180 : GOTO16270
16190 :   IFAW$<>CHR$(127)ORLEN(AN$)<=0ORKN>LEN(AN$)THENGOTO16220
16200 :     AN$=LEFT$(AN$,KN-2)+RIGHT$(AN$,LEN(AN$)-KN+1):KN=KN-1
16210 :     GOTO16270
16220 :   IFAW$<>CHR$(127)ORLEN(AN$)<=0ORKN<=LEN(AN$)THENGOTO16250
16230 :     AN$=LEFT$(AN$,LEN(AN$)-1):KN=KN-1
16240 :     GOTO16270
16250 :   IFAW$=CHR$(8)ANDKN>1THENKN=KN-1
16260 :   IFAW$=CHR$(9)ANDKN<LEN(AN$)+1THENKN=KN+1
16270 UNTILLEN(AN$)=MLANDKN=LEN(AN$)+1
16280 PRINT@XC1,YC;CHR$(131);AN$LEFT$(S$,ML-LEN(AN$));CHR$(129)
16300 RETURN
16310 :
16320 'MAKE RECTANGLE
16330 :
16340 GOSUB15210
16350 PRINT@XC-2,YC;CHR$(27);"H";CHR$(129);CHR$(125);
16360 PRINTLEFT$(B$,B);CHR$(126)
16370 FORN=1TOH
16380 : PRINT@XC-2,YC+N;CHR$(27);"H";CHR$(129);CHR$(91);
16390 : PRINTLEFT$(S$,B);CHR$(92)
16400 NEXTN
16410 PRINT@XC-2,YC+H+1;CHR$(27);"H";CHR$(129);CHR$(123);
16420 PRINTLEFT$(O$,B);CHR$(124)
16430 RETURN
16440 :
16450 'END OF GAME
16460 :
16470 CLS
16480 PRINT CHR$(131);"GOODBYE.";CHR$(17)
16490 CALL #6503
16500 END
16510 :
16520 'WAIT FOR KEYPRESS OR JOYSTICK
16530 :
16540 TT$=AL$+CHR$(13):TJ$="00000000":JM=1:GOSUB15660:JM=0:RETURN
16550 :
16560 'PRINT CENTERED
16570 :
16580 IF LEN(CT$)>=BTHENPRINTCT$;
16590 PRINTLEFT$(S$,(B-1-LEN(CT$))/2);CT$;
16600 RETURN
16610 :
16620 'DISK FILE ERROR ROUTINE
16630 :
16640 XC=4:YC=8:B=34:H=5:GOSUB16340
16650 PRINT@6,10;CHR$(134);"Disc error";CHR$(129)
16660 PRINT@6,11;CHR$(131);"Press key.";CHR$(129):GOSUB16540:GOSUB15280
16670 RETURN
16680 :
16690 'NEXT MUSIC TRACK
16700 :
16710 CALL #6503
16720 MU=MU+1:IFMU>3THENMU=1
16730 LOAD "MUSIC"+STR$(MU)+".BIN"
16740 CALL #6500
16750 RETURN
16760 :
16770 'GAME DATA
16780 :
16790 'PAWN POSITION CO-ORDS MAIN
16800 DATA  2,13,  5,13,  8,13, 11,13, 14,13
16810 DATA 14,11, 14, 9, 14, 7, 14, 5, 17, 5
16820 DATA 20, 5, 20, 7, 20, 9, 20,11, 20,13
16830 DATA 23,13, 26,13, 29,13, 32,13, 32,15
16840 DATA 32,17, 29,17, 26,17, 23,17, 20,17
16850 DATA 20,19, 20,21, 20,23, 20,25, 17,25
16860 DATA 14,25, 14,23, 14,21, 14,19, 14,17
16870 DATA 11,17,  8,17,  5,17,  2,17,  2,15
16880 :
16890 'PAWN POS CO-ORDS START AND DEST
16900 DATA  2, 5,  5, 5,  2, 7,  5, 7,  5,15,  8,15, 11,15, 14,15
16910 DATA 29, 5, 32, 5, 29, 7, 32, 7, 17, 7, 17, 9, 17,11, 17,13
16920 DATA 29,23, 32,23, 29,25, 32,25, 29,15, 26,15, 23,15, 20,15
16930 DATA  2,23,  5,23,  2,25,  5,25, 17,23, 17,21, 17,19, 17,17
16940 :
16950 'PLAYER COLORS
16960 DATA 2,1,4,3
16970 :
16980 'DICE PRINT STRINGS
16990 DATA 188,189,190,191
17000 DATA 192,193,193,194
17010 DATA 195,189,190,196
17020 DATA 192,197,198,194
17030 DATA 195,199,200,196
17040 DATA 201,201,202,202
17050 :
17060 'MENU DATA
17070 :
17080 DATA 4,3
17090 DATA "Game",3,"Throw dice","Restart","Stop"
17100 DATA "Disc",2,"Save game","Load game"
17110 DATA "Music",3,"Next","Stop","Restart"
17120 DATA "Information",1,"Credits"
17130 DATA 2,"Yes","No"
17140 DATA 2,"Restart","Stop"
17150 DATA 3,"Continue game","New game","Stop"
17160 :
17170 '
17180 'END OF PROGRAM
17190 '
